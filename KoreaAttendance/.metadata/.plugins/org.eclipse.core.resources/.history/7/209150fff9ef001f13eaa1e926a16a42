package com.korea.attendance.controller;

import com.korea.attendance.model.Classroom;
import com.korea.attendance.service.ClassService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/classes")
public class ClassController {

    private static final Logger logger = LoggerFactory.getLogger(ClassController.class);
    private final ClassService classService;

    public ClassController(ClassService classService) {
        this.classService = classService;
    }

    @GetMapping("/{userId}")
    public List<Classroom> getUserClasses(@PathVariable("userId") String userId) {
        logger.info("ğŸ“Œ [DEBUG] ê°•ì˜ì‹¤ ëª©ë¡ ì¡°íšŒ ìš”ì²­ ë„ì°©: userId={}", userId);

        List<Classroom> classes = classService.getClassesByUserId(userId);

        logger.info("ğŸ“Œ [DEBUG] ì¡°íšŒëœ ê°•ì˜ì‹¤ ê°œìˆ˜: {}", classes.size());
        logger.info("ğŸ“Œ [DEBUG] ì¡°íšŒëœ ê°•ì˜ì‹¤ ë¦¬ìŠ¤íŠ¸: {}", classes);  // âœ… ë¦¬ìŠ¤íŠ¸ ì „ì²´ ì¶œë ¥

        return classes;
    }
    
    @GetMapping("/all")
    public ResponseEntity<List<Class>> getAllClasses() {
        List<Class> classes = classService.getAllClasses();
        System.out.println("ğŸ“Œ ë¶ˆëŸ¬ì˜¨ ê°•ì˜ì‹¤ ëª©ë¡: " + classes); // âœ… ì½˜ì†” ë¡œê·¸ í™•ì¸
        return ResponseEntity.ok(classes);
    }


    
    @PostMapping("/add")
    public ResponseEntity<?> addClassroom(@RequestBody Classroom newClass) {
        classService.addClassroom(newClass);
        return ResponseEntity.ok("ê°•ì˜ì‹¤ ì¶”ê°€ ì™„ë£Œ");
    }
    
 // âœ… ê°•ì˜ì‹¤ ì‚­ì œ API ì¶”ê°€
    @DeleteMapping("/{classId}")
    public ResponseEntity<?> deleteClass(@PathVariable("classId") int classId) {
        classService.deleteClassById(classId);
        return ResponseEntity.ok("ê°•ì˜ì‹¤ ì‚­ì œ ì„±ê³µ");
    }
}
